<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>Rust course</title>

  
  

  
    <link rel="stylesheet" href="https://mimuw-jnp2-rust.github.io/book.css">
  

  
  
</head>

<body>
<div class="menu">
  
  
  <nav role="navigation">
    <ul>
      <li><a href="https://mimuw-jnp2-rust.github.io">Home</a></li>
      
        
        
        
          
          <li >
            
            <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;">
              
              List of lessons
            </a>
            
              <ul>
                
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;00-organizational&#x2F;">
                        [2025-10-02]
                        
                        Organizational lesson
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;01-introduction&#x2F;">
                        [2024-10-02]
                        
                        Introduction to Rust
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;02-ownership&#x2F;">
                        [2025-10-09]
                        
                        Ownership Model
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;03-data-types&#x2F;">
                        [2025-10-16]
                        
                        Data Types
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                      
                    
                  
                  
                    <li class="upcoming">
                      <span class="upcoming-content">
                        <span class="upcoming-title">
                          [2022-10-31]
                          
                          Feedback #1
                        </span>
                        <span class="upcoming-note">Available 2022-10-31</span>
                      </span>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;05-types-reasoning&#x2F;">
                        [2025-10-23]
                        
                        Reasoning About Types
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;06-closures-iterators&#x2F;">
                        [2025-10-30]
                        
                        Closures and Iterators
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;07-smart-pointers&#x2F;">
                        [2025-11-06]
                        
                        Smart Pointers
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                      
                    
                  
                  
                    <li class="upcoming">
                      <span class="upcoming-content">
                        <span class="upcoming-title">
                          [2029-01-01]
                          
                          Feedback #2
                        </span>
                        <span class="upcoming-note">Available 2029-01-01</span>
                      </span>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;09-concurrency&#x2F;">
                        [2025-11-19]
                        
                        Fearless concurrency
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;10-design-patterns&#x2F;">
                        [2025-11-26]
                        
                        Design patterns
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;11-async-1&#x2F;">
                        [2025-12-03]
                        
                        Async: Part 1
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                      
                    
                  
                  
                    <li class="upcoming">
                      <span class="upcoming-content">
                        <span class="upcoming-title">
                          [2029-01-01]
                          
                          Project feedback
                        </span>
                        <span class="upcoming-note">Available 2029-01-01</span>
                      </span>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;13-async-2&#x2F;">
                        [2025-12-10]
                        
                        Async: Part 2
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;14-macros-1&#x2F;">
                        [2025-12-17]
                        
                        Macros: Part 1 (declarative)
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;15-macros-2&#x2F;">
                        [2026-01-07]
                        
                        Macros: Part 2 (procedural)
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;16-unsafe&#x2F;">
                        [2026-01-14]
                        
                        Unsafe Rust
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;project-showcase&#x2F;">
                        [2022-10-17]
                        
                        2021L Project showcase
                      </a>
                    </li>
                  
                
                  
                  
                  
                    
                    
                  
                  
                    <li >
                      <a href="https:&#x2F;&#x2F;mimuw-jnp2-rust.github.io&#x2F;lessons&#x2F;table-of-contents&#x2F;">
                        [2025-10-05]
                        
                        Table of content
                      </a>
                    </li>
                  
                
              </ul>
            
          </li>
        
      
    </ul>
  </nav>
  
  
</div>

<div class="page">
  <div class="page-header">
    <div class="menu-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
    
      <span class="search-icon">ðŸ”Ž</span>
    
  </div>

  <div class="page__content">
    
      <div class="search-container">
        <input id="search" type="search" placeholder="Search..">
        <div class="search-results">
          <div class="search-results__header"></div>
          <ul class="search-results__items"></ul>
        </div>
      </div>
    
    <div class="book-content">
      
<h1 class="title">Feedback #1</h1>
<p class="subtitle">
  <strong>2022-10-31</strong> (last edit: 2029-01-01)
</p>
<h2 id="feedback">Feedback</h2>
<h3 id="unwrapping">Unwrapping</h3>
<p>Instead of this:</p>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#8959a8;">if </span><span style="color:#c82829;">self</span><span>.favorite_color.</span><span style="color:#4271ae;">is_some</span><span>() {
</span><span>    </span><span style="color:#c82829;">self</span><span>.favorite_color.</span><span style="color:#4271ae;">as_mut</span><span>().</span><span style="color:#4271ae;">unwrap</span><span>().</span><span style="color:#4271ae;">lighten</span><span>();
</span><span>}
</span></code></pre>
<p>do this:</p>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#8959a8;">if let </span><span style="color:#c99e00;">Some</span><span>(</span><span style="color:#8959a8;">ref mut</span><span> color) </span><span style="color:#3e999f;">= </span><span style="color:#c82829;">self</span><span>.favorite_color {
</span><span>    color.</span><span style="color:#4271ae;">lighten</span><span>();
</span><span>}
</span></code></pre>
<p>or</p>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#8959a8;">if let </span><span style="color:#c99e00;">Some</span><span>(color) </span><span style="color:#3e999f;">= &amp;</span><span style="color:#8959a8;">mut </span><span style="color:#c82829;">self</span><span>.favorite_color {
</span><span>    color.</span><span style="color:#4271ae;">lighten</span><span>();
</span><span>}
</span></code></pre>
<p>(unwrapping is a code smell)</p>
<h3 id="spot-the-overflow">Spot the overflow</h3>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span>Color::Rgb(r, g, b) </span><span style="color:#3e999f;">=&gt; *</span><span>b </span><span style="color:#3e999f;">&gt; </span><span>(</span><span style="color:#3e999f;">*</span><span>r </span><span style="color:#3e999f;">+ *</span><span>g) </span><span style="color:#3e999f;">/ </span><span style="color:#f5871f;">2</span><span>,
</span></code></pre>
<h3 id="1-3">1/3</h3>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span>Color::Rgb(r, g, b) </span><span style="color:#3e999f;">=&gt; </span><span>(</span><span style="color:#3e999f;">*</span><span>b </span><span style="color:#3e999f;">as </span><span style="color:#8959a8;">u16</span><span>) </span><span style="color:#3e999f;">* </span><span style="color:#f5871f;">3 </span><span style="color:#3e999f;">&gt; </span><span>(</span><span style="color:#3e999f;">*</span><span>r </span><span style="color:#3e999f;">as </span><span style="color:#8959a8;">u16</span><span>) </span><span style="color:#3e999f;">+ </span><span>(</span><span style="color:#3e999f;">*</span><span>g </span><span style="color:#3e999f;">as </span><span style="color:#8959a8;">u16</span><span>) </span><span style="color:#3e999f;">+ </span><span>(</span><span style="color:#3e999f;">*</span><span>b </span><span style="color:#3e999f;">as </span><span style="color:#8959a8;">u16</span><span>),
</span></code></pre>
<p>No need to cast to u16. If b accounts for 1/3 of the sum, it's enough to check that it's bigger than both r and g.</p>
<h3 id="format">Format</h3>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span>Color::Named(</span><span style="color:#8959a8;">ref mut</span><span> name) </span><span style="color:#3e999f;">=&gt; *</span><span>name </span><span style="color:#3e999f;">= </span><span style="color:#718c00;">&quot;light &quot;</span><span>.</span><span style="color:#4271ae;">to_string</span><span>() </span><span style="color:#3e999f;">+</span><span> name,
</span></code></pre>
<p>There's a <code>format!</code> macro for this.</p>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span>Color::Named(</span><span style="color:#8959a8;">ref mut</span><span> name) </span><span style="color:#3e999f;">=&gt; *</span><span>name </span><span style="color:#3e999f;">= </span><span>format!(</span><span style="color:#718c00;">&quot;light </span><span style="color:#666969;">{name}</span><span style="color:#718c00;">&quot;</span><span>),
</span></code></pre>
<h3 id="from-vs-into-vs-as">From vs Into vs as</h3>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#8959a8;">let</span><span> tmp1: </span><span style="color:#8959a8;">u32 </span><span style="color:#3e999f;">= </span><span>&lt;</span><span style="color:#8959a8;">u8 </span><span style="color:#3e999f;">as </span><span style="color:#c99e00;">Into</span><span>&lt;</span><span style="color:#8959a8;">u32</span><span>&gt;&gt;::into(</span><span style="color:#3e999f;">*</span><span>c) </span><span style="color:#3e999f;">* </span><span style="color:#f5871f;">2</span><span>;
</span></code></pre>
<p>This could be written as</p>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#8959a8;">let</span><span> tmp1: </span><span style="color:#8959a8;">u32 </span><span style="color:#3e999f;">= </span><span>(</span><span style="color:#3e999f;">*</span><span>c).</span><span style="color:#4271ae;">into</span><span>() </span><span style="color:#3e999f;">* </span><span style="color:#f5871f;">2</span><span>;
</span></code></pre>
<p>or even simpler (note the omission of the type annotation):</p>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#8959a8;">let</span><span> tmp1 </span><span style="color:#3e999f;">= </span><span style="color:#8959a8;">u32</span><span>::from(</span><span style="color:#3e999f;">*</span><span>c) </span><span style="color:#3e999f;">* </span><span style="color:#f5871f;">2</span><span>;
</span></code></pre>
<p>However in most cases of numeric conversion you can just use <code>as</code>:</p>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#8959a8;">let</span><span> tmp1 </span><span style="color:#3e999f;">= *</span><span>c </span><span style="color:#3e999f;">as </span><span style="color:#8959a8;">u32 </span><span style="color:#3e999f;">* </span><span style="color:#f5871f;">2</span><span>;
</span></code></pre>
<p><a href="https://doc.rust-lang.org/std/convert/trait.Into.html">Into trait docs</a></p>
<h3 id="saturating-addition">Saturating addition</h3>
<p>There's a <code>saturating_add</code> method on <code>u8</code> which does exactly what we wanted.
But it was fun watching you struggle with it :)</p>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#8959a8;">fn </span><span style="color:#4271ae;">lighten</span><span>(</span><span style="color:#3e999f;">&amp;</span><span style="color:#8959a8;">mut </span><span style="color:#f5871f;">self</span><span>) {
</span><span>    </span><span style="color:#8959a8;">match </span><span style="color:#c82829;">self </span><span>{
</span><span>        Color::Named(name) </span><span style="color:#3e999f;">=&gt; *</span><span>name </span><span style="color:#3e999f;">= </span><span style="color:#718c00;">&quot;light &quot;</span><span>.</span><span style="color:#4271ae;">to_string</span><span>() </span><span style="color:#3e999f;">+</span><span> name,
</span><span>        Color::Rgb(r, g, b) </span><span style="color:#3e999f;">=&gt; </span><span>{
</span><span>            </span><span style="color:#3e999f;">*</span><span>r </span><span style="color:#3e999f;">=</span><span> r.</span><span style="color:#4271ae;">saturating_add</span><span>(</span><span style="color:#f5871f;">10</span><span>);
</span><span>            </span><span style="color:#3e999f;">*</span><span>g </span><span style="color:#3e999f;">=</span><span> g.</span><span style="color:#4271ae;">saturating_add</span><span>(</span><span style="color:#f5871f;">10</span><span>);
</span><span>            </span><span style="color:#3e999f;">*</span><span>b </span><span style="color:#3e999f;">=</span><span> b.</span><span style="color:#4271ae;">saturating_add</span><span>(</span><span style="color:#f5871f;">10</span><span>);
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<h3 id="exchange">Exchange</h3>
<pre data-lang="rust" style="background-color:#ffffff;color:#4d4d4c;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#8959a8;">fn </span><span style="color:#4271ae;">exchange_items</span><span>(</span><span style="color:#f5871f;">robot1</span><span>: </span><span style="color:#3e999f;">&amp;</span><span style="color:#8959a8;">mut</span><span> Robot, </span><span style="color:#f5871f;">robot2</span><span>: </span><span style="color:#3e999f;">&amp;</span><span style="color:#8959a8;">mut</span><span> Robot) {
</span><span>    mem::swap(</span><span style="color:#3e999f;">&amp;</span><span style="color:#8959a8;">mut</span><span> robot1.held_item, </span><span style="color:#3e999f;">&amp;</span><span style="color:#8959a8;">mut</span><span> robot2.held_item);
</span><span>}
</span></code></pre>
<p>Swap is the preferred way to exchange the contents of two variables.</p>
<h3 id="regex-nope">Regex? Nope</h3>
<p>There's no need to use a regex here. String has a <code>contains</code> method.</p>
<p>If you <strong>really</strong> want to use a regex,
you can use the <code>lazy_static</code> crate to avoid recompiling the regex every time you call the function.</p>


    </div>
  </div>

  <div class="prev-link">
    
    
  </div>

  <div class="next-link">
    
    
  </div>
</div>


  
  <script type="text/javascript" src="https://mimuw-jnp2-rust.github.io/elasticlunr.min.js"></script>
  <script type="text/javascript" src="https://mimuw-jnp2-rust.github.io/search_index.en.js"></script>
  
  <script type="text/javascript" src="https://mimuw-jnp2-rust.github.io/book.js"></script>

</body>

</html>
